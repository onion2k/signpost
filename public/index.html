<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>It's A Sign</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/materialize.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <style>
          canvas {
            padding: 0;
            margin: 0;
          }
        </style>
    </head>
    <body>

    <div class="navbar-fixed">
      <nav class="light-blue">
          <div class="nav-wrapper">
            <a href="#" class="brand-logo" style="margin-left: 10px;">It's A Sign</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
              <li><a href="sass.html">About</a></li>
              <li><a href="badges.html">Buy A Sign</a></li>
              <li><a href="sass.html">Custom Signs</a></li>
            </ul>
            <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
          </div>
      </nav>
    </div>

    <div class="row" style="margin-bottom: 0 !important; padding-bottom: 0;">
        <div class="col s4">

          <ul id="placelist" ref="placelist" class="collapsible" data-collapsible="accordion" style="margin-top: 15px;">

            <place v-for="place in places" v-bind:place="place" :key="place.place"></place>

            <li id="newplaceform">
              <div class="collapsible-header active"><i class="material-icons">location_on</i>Add a new place</div>
              <div class="collapsible-body" style="overflow: auto;">
                <form id="addplace">
                  <div class="form-group">
                    <label for="placename">Place</label>
                    <input type="text" class="form-control" v-model="place" placeholder="Eg Sunderland, UK">
                  </div>
                  <div class="form-group">
                    <label for="title">Title (Optional)</label>
                    <input type="text" class="form-control" v-model="title" placeholder="Eg Allison's House'">
                  </div>
                  <button type="button" id="addnewplace" v-on:click="addPlace" class="btn right">Add Place</button>
                </form>
              </div>
            </li>

          </ul>

        </div>
        <div class="col s8 no-padding">
           <div style="min-height: 600px; padding: 0;" id="wrapper"></div>
        </div>
    </div>
    <footer class="page-footer">
        <div class="row">
          <div class="col l6 s12">
            <h5 class="white-text">Footer Content</h5>
            <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
          </div>
          <div class="col l4 offset-l2 s12">
            <h5 class="white-text">Links</h5>
            <ul>
              <li><a class="grey-text text-lighten-3" href="#!">Link 1</a></li>
              <li><a class="grey-text text-lighten-3" href="#!">Link 2</a></li>
              <li><a class="grey-text text-lighten-3" href="#!">Link 3</a></li>
              <li><a class="grey-text text-lighten-3" href="#!">Link 4</a></li>
            </ul>
          </div>
        </div>
      <div class="footer-copyright" style="padding-left: 10px;">
        Made by Onion2k
      </div>
    </footer>




        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="js/materialize.min.js"></script>
        <script src="js/vue.js"></script>
        <script src="dist/signpost.js"></script>
        <script src="/socket.io/socket.io.js"></script>

        <script>

          var socket = io.connect('http://localhost:8081');

          Vue.component('place', {
            props: ['place'],
            template: '<li>\
              <div class="collapsible-header"><i class="material-icons">label</i>{{ place.title || place.place }}<span class="secondary-content">Click to edit</span></div>\
              <div class="collapsible-body" style="overflow: auto;">\
                <form id="editplace">\
                  <div class="form-group">\
                    <label for="placename">Place</label>\
                    <input type="text" class="form-control" placeholder="A place or an address" v-model.lazy="place.place">\
                  </div>\
                  <div class="form-group">\
                    <label for="title">Title (Optional)</label>\
                    <input type="text" class="form-control" placeholder="Eg Allison\'s house" v-model.lazy="place.title">\
                  </div>\
                  <button type="button" v-on:click.native="editPlace" class="btn right">Update Place</button>\
                </form>\
              </div>\
            </li>',
            methods: {
              editPlace: function () {
                console.log('place', this.place);
              }
            }
          })

          var app = new Vue({
            el: '#placelist',
            data: {
              place: '',
              title: '',
              places: []
            },
            methods: {
              addPlace: function (event) {
                socket.emit('geocode', { place: this.place, title: this.title });
              },
              doSomething: function(title, place){
                this.places.push({ title: title, place: place });
              }
            }
          });

          socket.on('geocode', function (data) {
            signpost.arm(data[0].title || data[0].placename, data[0].bearing, data[0].distance);
            app.doSomething(data[0].title, data[0].placename);
          });

        </script>

    </body>
</html>
